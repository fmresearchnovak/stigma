<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module SmaliMethodDef</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title">SmaliMethodDef</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:/home/ed/stigma/lib/SmaliMethodDef.py">/home/ed/stigma/lib/SmaliMethodDef.py</a></td></tr></table>
    <p></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="Instrumenter.html">Instrumenter</a><br>
<a href="lib.SmaliTypes.html">lib.SmaliTypes</a><br>
</td><td class="multicolumn"><a href="lib.StigmaStringParsingLib.html">lib.StigmaStringParsingLib</a><br>
<a href="inspect.html">inspect</a><br>
</td><td class="multicolumn"><a href="os.html">os</a><br>
<a href="re.html">re</a><br>
</td><td class="multicolumn"><a href="lib.SmaliAssemblyInstructions.html">lib.SmaliAssemblyInstructions</a><br>
<a href="sys.html">sys</a><br>
</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor index-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Classes</strong></td></tr>
    
<tr><td class="decor index-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl>
<dt class="heading-text"><a href="builtins.html#object">builtins.object</a>
</dt><dd>
<dl>
<dt class="heading-text"><a href="SmaliMethodDef.html#SmaliMethodDef">SmaliMethodDef</a>
</dt><dt class="heading-text"><a href="SmaliMethodDef.html#SmaliMethodSignature">SmaliMethodSignature</a>
</dt></dl>
</dd>
</dl>
 <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="SmaliMethodDef">class <strong>SmaliMethodDef</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#SmaliMethodDef">SmaliMethodDef</a>(text,&nbsp;scd)<br>
&nbsp;<br>
<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="SmaliMethodDef-__eq__"><strong>__eq__</strong></a>(self, other)</dt><dd><span class="code">Return&nbsp;self==value.</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-__init__"><strong>__init__</strong></a>(self, text, scd)</dt><dd><span class="code">Initialize&nbsp;self.&nbsp;&nbsp;See&nbsp;help(type(self))&nbsp;for&nbsp;accurate&nbsp;signature.</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-__repr__"><strong>__repr__</strong></a>(self)</dt><dd><span class="code">Return&nbsp;repr(self).</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-__str__"><strong>__str__</strong></a>(self)</dt><dd><span class="code">Return&nbsp;str(self).</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-convert_all_lines_p_to_v_numbers"><strong>convert_all_lines_p_to_v_numbers</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-dereference_p_to_v_number"><strong>dereference_p_to_v_number</strong></a>(self, p_register)</dt><dd><span class="code">Return&nbsp;the&nbsp;local&nbsp;register&nbsp;representation&nbsp;of&nbsp;a&nbsp;parameter&nbsp;register.<br>
&nbsp;<br>
Parameters:<br>
p_register:&nbsp;the&nbsp;register&nbsp;being&nbsp;dereferenced<br>
&nbsp;<br>
Returns:<br>
v_num:&nbsp;the&nbsp;register's&nbsp;corresponding&nbsp;local&nbsp;register&nbsp;number</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-dereference_p_to_v_numbers"><strong>dereference_p_to_v_numbers</strong></a>(self, line)</dt><dd><span class="code">Returns&nbsp;the&nbsp;dereferenced&nbsp;(all&nbsp;parameter&nbsp;registers&nbsp;represented&nbsp;as&nbsp;local&nbsp;registers)&nbsp;version&nbsp;of&nbsp;a<br>
full&nbsp;line&nbsp;of&nbsp;smali&nbsp;code.<br>
&nbsp;<br>
Parameters:<br>
line:&nbsp;The&nbsp;line&nbsp;of&nbsp;smali&nbsp;code&nbsp;to&nbsp;dereference&nbsp;registers&nbsp;in.<br>
&nbsp;<br>
Returns:<br>
line:&nbsp;The&nbsp;original&nbsp;line&nbsp;of&nbsp;smali&nbsp;code&nbsp;with&nbsp;all&nbsp;the&nbsp;parameter&nbsp;registers&nbsp;replaced&nbsp;by&nbsp;their&nbsp;local&nbsp;counterpart.</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-embed_block"><strong>embed_block</strong></a>(self, position, block)</dt></dl>

<dl><dt><a name="SmaliMethodDef-embed_block_with_replace"><strong>embed_block_with_replace</strong></a>(self, position, block)</dt></dl>

<dl><dt><a name="SmaliMethodDef-embed_line"><strong>embed_line</strong></a>(self, position, line)</dt></dl>

<dl><dt><a name="SmaliMethodDef-find_first_valid_instruction"><strong>find_first_valid_instruction</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;the&nbsp;first&nbsp;valid&nbsp;instruction&nbsp;in&nbsp;the&nbsp;smali&nbsp;method.<br>
&nbsp;<br>
Returns:<br>
i:&nbsp;the&nbsp;line&nbsp;number&nbsp;of&nbsp;the&nbsp;first&nbsp;valid&nbsp;instruction</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-get_fully_qualified_name"><strong>get_fully_qualified_name</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;this&nbsp;method,&nbsp;a&nbsp;string<br>
Example:&nbsp;Lcom/example/MyClass;-&gt;myMethod(Ljava/lang/String;)V<br>
Wrapper&nbsp;function&nbsp;for&nbsp;the&nbsp;get_fully_qualified_name&nbsp;of&nbsp;this&nbsp;method's&nbsp;<a href="#SmaliMethodSignature">SmaliMethodSignature</a>&nbsp;<a href="builtins.html#object">object</a></span></dd></dl>

<dl><dt><a name="SmaliMethodDef-get_locals_directive_line"><strong>get_locals_directive_line</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-get_locals_directive_num"><strong>get_locals_directive_num</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-get_name"><strong>get_name</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-get_num_comparison_instructions"><strong>get_num_comparison_instructions</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;smali&nbsp;instructions&nbsp;that&nbsp;compare&nbsp;two&nbsp;registers&nbsp;(or&nbsp;one&nbsp;register&nbsp;and&nbsp;the&nbsp;integer&nbsp;0)&nbsp;which&nbsp;can&nbsp;be&nbsp;either<br>
if&nbsp;instructions&nbsp;(jump&nbsp;to&nbsp;a&nbsp;line&nbsp;if&nbsp;a&nbsp;condition&nbsp;is&nbsp;met)&nbsp;or&nbsp;a&nbsp;cmp&nbsp;instruction&nbsp;(store&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;comparison&nbsp;in&nbsp;a&nbsp;different<br>
register)<br>
&nbsp;<br>
Returns:<br>
count:&nbsp;Number&nbsp;of&nbsp;smali&nbsp;instructions&nbsp;that&nbsp;either&nbsp;start&nbsp;with&nbsp;if&nbsp;or&nbsp;cmp</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-get_num_registers"><strong>get_num_registers</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;registers&nbsp;used&nbsp;by&nbsp;the&nbsp;Smali&nbsp;method.<br>
&nbsp;<br>
Returns:<br>
ans:&nbsp;the&nbsp;number&nbsp;of&nbsp;local&nbsp;registers&nbsp;plus&nbsp;the&nbsp;number&nbsp;of&nbsp;parameter&nbsp;registers</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-get_register_meta_data"><strong>get_register_meta_data</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;<a href="#SmaliMethodDef">SmaliMethodDef</a>&nbsp;metadata,&nbsp;with&nbsp;each&nbsp;local&nbsp;register&nbsp;used&nbsp;by&nbsp;the&nbsp;function&nbsp;and&nbsp;the<br>
parameter&nbsp;register&nbsp;they&nbsp;correspond&nbsp;to,&nbsp;if&nbsp;applicable.<br>
&nbsp;<br>
Returns:<br>
str(l):&nbsp;the&nbsp;output&nbsp;string,&nbsp;formatted&nbsp;like&nbsp;this:&nbsp;v0,&nbsp;v1,&nbsp;v2/p0,&nbsp;v3/p1...</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-get_signature"><strong>get_signature</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-grow_locals"><strong>grow_locals</strong></a>(self, n)</dt><dd><span class="code">Grows&nbsp;the&nbsp;.locals&nbsp;in&nbsp;the&nbsp;method&nbsp;to&nbsp;allow&nbsp;for&nbsp;more&nbsp;local&nbsp;registers&nbsp;to&nbsp;be&nbsp;used&nbsp;for&nbsp;new&nbsp;instructions.&nbsp;The&nbsp;code&nbsp;ensures&nbsp;that&nbsp;existing&nbsp;registers<br>
moved&nbsp;to&nbsp;new&nbsp;ones&nbsp;(due&nbsp;to&nbsp;the&nbsp;.locals&nbsp;increasing)&nbsp;refer&nbsp;to&nbsp;the&nbsp;correct&nbsp;locations&nbsp;and&nbsp;existing&nbsp;low-number&nbsp;registers&nbsp;are&nbsp;not&nbsp;moved&nbsp;to&nbsp;high-number<br>
registers.<br>
Why&nbsp;use&nbsp;grow_locals?&nbsp;&nbsp;The&nbsp;purpose&nbsp;of&nbsp;this&nbsp;method&nbsp;is&nbsp;to&nbsp;make&nbsp;it&nbsp;easier&nbsp;(possible)&nbsp;to&nbsp;add&nbsp;new&nbsp;instructions<br>
interleaved&nbsp;into&nbsp;existing&nbsp;smali&nbsp;instructions.&nbsp;&nbsp;The&nbsp;existing&nbsp;method&nbsp;smali&nbsp;code&nbsp;will&nbsp;have&nbsp;registers,&nbsp;but&nbsp;those<br>
registers&nbsp;likely&nbsp;contain&nbsp;data&nbsp;the&nbsp;program&nbsp;needs&nbsp;to&nbsp;run.&nbsp;&nbsp;Calling&nbsp;grow_locals&nbsp;creates&nbsp;some&nbsp;new&nbsp;registers&nbsp;that&nbsp;are&nbsp;not<br>
users&nbsp;by&nbsp;the&nbsp;existing&nbsp;smali&nbsp;code&nbsp;and&nbsp;can&nbsp;be&nbsp;used&nbsp;freely&nbsp;to&nbsp;store&nbsp;data&nbsp;for&nbsp;the&nbsp;new&nbsp;instructions&nbsp;to&nbsp;be&nbsp;inserted&nbsp;/&nbsp;interleaved.<br>
&nbsp;<br>
Parameters:<br>
n:&nbsp;the&nbsp;number&nbsp;of&nbsp;new&nbsp;local&nbsp;registers&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;method</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-instrument"><strong>instrument</strong></a>(self)</dt><dd><span class="code">Inserts&nbsp;line&nbsp;into&nbsp;a&nbsp;smali&nbsp;file.&nbsp;Code&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;first&nbsp;line&nbsp;of&nbsp;every&nbsp;method&nbsp;or&nbsp;in&nbsp;the&nbsp;first&nbsp;line&nbsp;of<br>
the&nbsp;first&nbsp;method&nbsp;in&nbsp;the&nbsp;file.&nbsp;Creates&nbsp;a&nbsp;graph&nbsp;to&nbsp;store&nbsp;the&nbsp;blocks&nbsp;of&nbsp;if&nbsp;statements&nbsp;and&nbsp;other&nbsp;conditionals.</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-is_relevant"><strong>is_relevant</strong></a>(self, line, containing_node)</dt><dd><span class="code">Determnines&nbsp;whether&nbsp;code&nbsp;should&nbsp;be&nbsp;inserted&nbsp;into&nbsp;a&nbsp;smali&nbsp;method.<br>
&nbsp;<br>
Parameters:<br>
line:&nbsp;the&nbsp;existing&nbsp;line&nbsp;of&nbsp;code&nbsp;where&nbsp;we&nbsp;want&nbsp;to&nbsp;put&nbsp;our&nbsp;new&nbsp;code<br>
containing_node:&nbsp;the&nbsp;node&nbsp;(segment&nbsp;of&nbsp;code&nbsp;created&nbsp;by&nbsp;the&nbsp;control&nbsp;flow&nbsp;graph)&nbsp;that&nbsp;the&nbsp;line&nbsp;of&nbsp;code&nbsp;is&nbsp;in<br>
&nbsp;<br>
Returns:<br>
A&nbsp;boolean</span></dd></dl>

<dl><dt><a name="SmaliMethodDef-make_new_jump_label"><strong>make_new_jump_label</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-make_new_try_start_label"><strong>make_new_try_start_label</strong></a>(self)</dt></dl>

<dl><dt><a name="SmaliMethodDef-set_locals_directive"><strong>set_locals_directive</strong></a>(self, new_val)</dt></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object</span></dd>
</dl>
<hr>
Data and other attributes defined here:<br>
<dl><dt><strong>__hash__</strong> = None</dl>

</td></tr></table> <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="SmaliMethodSignature">class <strong>SmaliMethodSignature</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#SmaliMethodSignature">SmaliMethodSignature</a>(sig_line,&nbsp;class_name)<br>
&nbsp;<br>
<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="SmaliMethodSignature-__eq__"><strong>__eq__</strong></a>(self, other)</dt><dd><span class="code">Return&nbsp;self==value.</span></dd></dl>

<dl><dt><a name="SmaliMethodSignature-__init__"><strong>__init__</strong></a>(self, sig_line, class_name)</dt><dd><span class="code">Initialize&nbsp;self.&nbsp;&nbsp;See&nbsp;help(type(self))&nbsp;for&nbsp;accurate&nbsp;signature.</span></dd></dl>

<dl><dt><a name="SmaliMethodSignature-__str__"><strong>__str__</strong></a>(self)</dt><dd><span class="code">Return&nbsp;str(self).</span></dd></dl>

<dl><dt><a name="SmaliMethodSignature-get_fully_qualified_name"><strong>get_fully_qualified_name</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;method&nbsp;(how&nbsp;it&nbsp;appears&nbsp;in&nbsp;Smali&nbsp;code)<br>
Returns:<br>
self.<strong>class_name</strong>&nbsp;-&gt;&nbsp;self.<strong>name_with_data_types</strong>,&nbsp;(a&nbsp;string)<br>
&nbsp;<br>
Example:&nbsp;Lcom/example/MyClass;-&gt;myMethod(Ljava/lang/String;)V</span></dd></dl>

<dl><dt><a name="SmaliMethodSignature-get_name"><strong>get_name</strong></a>(self)</dt><dd><span class="code">Returns&nbsp;the&nbsp;name&nbsp;of&nbsp;this&nbsp;method&nbsp;and&nbsp;nothing&nbsp;else<br>
Example:&nbsp;if&nbsp;the&nbsp;function&nbsp;is&nbsp;Lcom/example/MyClass;-&gt;myMethod(Ljava/lang/String;)V&nbsp;this&nbsp;method&nbsp;returns&nbsp;"myMethod"&nbsp;a&nbsp;string</span></dd></dl>

<hr>
Static methods defined here:<br>
<dl><dt><a name="SmaliMethodSignature-fast_forward_to_not_bracket"><strong>fast_forward_to_not_bracket</strong></a>(idx, string)</dt><dd><span class="code">Returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;non-start&nbsp;bracket&nbsp;in&nbsp;a&nbsp;string.<br>
&nbsp;<br>
Parameters:<br>
idx:&nbsp;current&nbsp;index<br>
string:&nbsp;String&nbsp;representation&nbsp;of&nbsp;a&nbsp;Smali&nbsp;method&nbsp;parameter<br>
&nbsp;<br>
Returns:<br>
idx:&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;non-start&nbsp;bracket</span></dd></dl>

<dl><dt><a name="SmaliMethodSignature-fast_forward_to_semicolon"><strong>fast_forward_to_semicolon</strong></a>(idx, string)</dt><dd><span class="code">Returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;semicolon&nbsp;in&nbsp;a&nbsp;string.<br>
&nbsp;<br>
Parameters:<br>
idx:&nbsp;current&nbsp;index<br>
string:&nbsp;String&nbsp;representation&nbsp;of&nbsp;a&nbsp;Smali&nbsp;method&nbsp;parameter<br>
&nbsp;<br>
Returns:<br>
idx:&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;semicolon</span></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object</span></dd>
</dl>
<hr>
Data and other attributes defined here:<br>
<dl><dt><strong>__hash__</strong> = None</dl>

</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-tests"><strong>tests</strong></a>()</dt></dl>
</td></tr></table>
</body></html>